/**
 * Swipe Panel Class (beta)
 *
 * (c) 2012 Andrea Blasio
 *
 * Released under MIT License & GNU Free Documentation License
 *
 * Demo page: http://www.humanafragilitas.com/demos/swipe_panel/swipePanel.php
 *
 * Further insight:
 */

if("undefined"===typeof HF)var HF={};
HF.SwipePanel=function(q){function F(){var a,c=[],f=[],d=[];c.push("display: inline-block;");c.push("padding: 0 18px 0 18px;");c.push("background-image: "+g.repeatingLinearGradient);c.push("(90deg, ");c.push(e.swipePanelLabelColours[0]+", ");c.push(e.swipePanelLabelColours[0]+" 1px, ");c.push(e.swipePanelLabelColours[1]+" 1px, ");c.push(e.swipePanelLabelColours[1]+" 2px);");c.push(g.transition+":"+g.transform+" 0.15s ease-out;");c.push("height: 48px;");c.push("line-height: 48px;");c.push("cursor: move;");
c.push(g.userSelect+": none;");c.push("z-index: "+(e.swipePanelZIndex+1)+";");f.push("border-top-left-radius: 0;");f.push("border-top-right-radius: 0;");f.push("border-bottom-left-radius: 4px;");f.push("border-bottom-right-radius: 4px;");f.push("text-shadow: 0 -1px #fade92;");f.push("box-shadow: 0 2px 4px rgba(0,0,0,.5),");f.push("0 1px 1px rgba(0,0,0,.2),");f.push("0 1px 1px #53441C inset;");d.push("border-top-left-radius: 4px;");d.push("border-top-right-radius: 4px;");d.push("border-bottom-left-radius: 0;");
d.push("border-bottom-right-radius: 0;");d.push("text-shadow: 0 1px ");d.push(e.swipePanelLabelColours[2]+";");d.push("box-shadow: 0 -2px 5px rgba(0,0,0,.7),");d.push("0 -1px 1px rgba(0,0,0,.4),");d.push("0 -1px 1px #53441C inset;");a=r.createElement("span");a.setAttribute("id",e.panelLabelIDString);a.style.cssText=c.join("");a.setStatus=function(b){switch(b){case "closed":a.style.cssText=c.join("")+d.join("");a.innerHTML=e.panelLabelClosedTag;a.style[g.domTransform]=k(0,-1*a.offsetHeight,0);break;
case "open":a.style.cssText=c.join("")+f.join(""),a.innerHTML=e.panelLabelOpenTag,a.style[g.domTransform]=k(0,0,0)}};return a}function G(a){var c,f,d;d=[];var b=[];d.push("position: absolute;");d.push("top: 0;");d.push("background:");d.push(g.radialGradient+"(50% 50%, ellipse cover, rgba(0,0,0,.3) 0%, rgba(0,0,0,1) 130%),");d.push(g.repeatingLinearGradient);d.push("(0deg, "+e.swipePanelWrapperColours[0]+" 0px,");d.push(e.swipePanelWrapperColours[1]+" 2px,");d.push(e.swipePanelWrapperColours[1]+" 4px);");
d.push("text-align: center;");d.push("box-shadow: 0 0 8px rgba(0,0,0,.7) inset,");d.push("0 0 3px rgba(0,0,0,.7) inset,");d.push("0 -1px 1px rgba(255,255,255,.3);");d.push("cursor: move;");b.push("position: relative;");b.push("width: 100%;");b.push("height: 1px;");b.push("z-index: "+e.swipePanelZIndex+";");a.style.cssText=d.join("");a.isOpen=!1;a.hasChangedStatus=!1;a.isDragged=!1;d=r.createElement("div");d.style.cssText=b.join("");f=new F;f.setStatus("closed");d.appendChild(f);0<(c=a.childNodes).length?
a.insertBefore(d,c[0]):a.appendChild(d);a.getLabelInstance=function(){return f};a.getLabelHeight=function(){return f.offsetHeight};a.updateSize=function(c){a.style.width=c.width+"px";a.style.height=c.height+"px";!1===a.isOpen&&a.move("close",!1,c.height)};a.updatePanelLabel=function(){a.isOpen?f.setStatus("open"):f.setStatus("closed")};a.move=function(c,d,b){a.style[g.domTransition]=d?g.transform+" 0.3s ease-in-out":"none";switch(c){case "close":a.isOpen?a.hasChangedStatus=!0:a.hasChangedStatus=!1;
a.isOpen=!1;a.isDragged=!1;a.style[g.domTransform]=k(0,b,0);break;case "open":!a.isOpen?a.hasChangedStatus=!0:a.hasChangedStatus=!1;a.isOpen=!0;a.isDragged=!1;a.style[g.domTransform]=k(0,0,0);break;case "drag":a.style[g.domTransform]=k(0,b,0),a.isDragged=!0}};return a}var h=window,r=h.document,l=r.body.style,o,s,t,A,v,w,B,C,x,g,i,j,k,e={offsetParent:"",panelID:"",panelLabelIDString:"",panelLabelOpenTag:"",panelLabelClosedTag:"",swipePanelWrapperColours:["#454545","#242424"],swipePanelLabelColours:["#F8B708",
"#F9CC52","#fade92"],swipePanelZIndex:9998,swipeSensivity:7,onReady:null,onBeforeOpen:null,onOpen:null,onBeforeClose:null,onClose:null},u,p,m;i={buildInterface:function(){try{u=r.querySelector(e.panelID),m=u.offsetParent}catch(a){throw Error("Swipe Panel: illegal panelID and/or offset element.");}if(!u||!m)throw Error("Swipe Panel: panelID and/or offset element do not exist.");p=new G(u);p.updatePanelLabel();m.style.overflow="hidden";"function"===typeof e.onReady&&e.onReady.call(p)},getOffsetParentSize:function(){var a,
c;a=m.offsetWidth;c=m.offsetHeight;return{width:a,height:c,isLandscape:c<a}},getOffsetParentInstance:function(){return m},getWrapperInstance:function(){return p},getLabelInstance:function(){return p.getLabelInstance()}};var y,b,z,D=0,E=0,n=0;j={attachEventListeners:function(){b=i.getWrapperInstance();z=i.getLabelInstance();y=i.getOffsetParentInstance();z.addEventListener(A,j.touchStartHandler,!1);z.addEventListener(w,j.touchEndHandler,!1);h.addEventListener(C,j.resizeHandler,!1);h.addEventListener(B,
j.resizeHandler,!1);j.resizeHandler(null)},transitionEndHandler:function(){b.removeEventListener(x,j.transitionEndHandler);b.updatePanelLabel();!b.isOpen&&(b.hasChangedStatus&&"function"===typeof e.onOpen)&&e.onClose.call(b);b.isOpen&&(b.hasChangedStatus&&"function"===typeof e.onClose)&&e.onOpen.call(b);n=0},touchStartHandler:function(a){a.preventDefault();b.isDragged||(a.preventDefault(),D=a.screenY||a.touches[0].screenY,y.addEventListener(v,j.touchMoveHandler,!1))},touchMoveHandler:function(a){var c;
a.preventDefault();c=i.getOffsetParentSize();E=a.screenY||a.touches[0].screenY;n=Math.abs(D-E);b.move("drag",!1,b.isOpen?n:c.height-n)},touchEndHandler:function(a){a.preventDefault();a=i.getOffsetParentSize();y.removeEventListener(v,j.touchMoveHandler);b.addEventListener(x,j.transitionEndHandler,!1);n>a.height/e.swipeSensivity?b.isOpen?(b.move("close",!0,a.height),e.onBeforeClose.call(swipePanel)):(b.move("open",!0,0),e.onBeforeOpen.call(swipePanel)):b.isOpen?b.move("open",!0,0):b.move("close",!0,
a.height)},resizeHandler:function(){var a;a=i.getOffsetParentSize();b.updateSize(a);!1===b.isOpen&&b.move("close",!1,a.height)},dispatchCustomEvent:function(a,c,b){!0===b&&(b=i.getOffsetParentSize(),n=b.height/e.swipeSensivity+1);b=document.createEvent("HTMLEvents");b.initEvent(a,!0,!0);b.eventName=a;c.dispatchEvent(b)}};k=function(){k=g.translate3d?function(a,b,e){return"translate3d("+a+"px, "+b+"px, "+e+")"}:function(a,b){return"translate("+a+"px, "+b+"px)"};k()};s="ontouchstart"in h&&"ontouchmove"in
h&&"ontouchend"in h&&"ontouchcancel"in h;t="onmspointerdown"in h&&"onmspointermove"in h&&"onmspointerup"in h&&"onmspointerover"in h&&"onmspointerout"in h;A=s?"touchstart":t?"MSPointerDown":"mousedown";v=s?"touchmove":t?"MSPointerMove":"mousemove";w=s?"touchend":t?"MSPointerUp":"mouseup";B="orientationchange";C="resize";x="onwebkittransitionend"in h?"webkitTransitionEnd":"transitionend";g="MozTransition"in l&&"MozTransform"in l?{domTransition:"MozTransition",transition:"-moz-transition",transform:"-moz-transform",
domTransform:"MozTransform",radialGradient:"-moz-radial-gradient",repeatingLinearGradient:"-moz-repeating-linear-gradient",translate3d:"translate3d",userSelect:"-moz-user-select"}:"WebkitTransition"in l&&"WebkitTransform"in l?{domTransition:"WebkitTransition",transition:"-webkit-transition",transform:"-webkit-transform",domTransform:"WebkitTransform",radialGradient:"-webkit-radial-gradient",repeatingLinearGradient:"-webkit-repeating-linear-gradient",translate3d:"translate3d",userSelect:"-webkit-user-select"}:
"msTransition"in l&&"msTransform"in l?{domTransition:"msTransition",transition:"-ms-transition",transform:"-ms-transform",domTransform:"msTransform",radialGradient:"-ms-radial-gradient",repeatingLinearGradient:"-ms-repeating-linear-gradient",_translate:"translate",userSelect:"-ms-user-select"}:{domTransition:"transition",transition:"transition",transform:"transform",domTransform:"transform",radialGradient:"radial-gradient",repeatingLinearGradient:"repeating-linear-gradient",userSelect:"user-select"};
if("object"!==typeof q)throw Error("SwipePanel: initialize method argument is not an object.");for(o in e)q.hasOwnProperty(o)&&q[o]&&(e[o]=q[o]);i.buildInterface();j.attachEventListeners();HF.SwipePanel.prototype.toggle=function(){j.dispatchCustomEvent(w,i.getLabelInstance(),!0)};HF.SwipePanel.prototype.open=function(){!1===i.getWrapperInstance().isOpen&&this.toggle()};HF.SwipePanel.prototype.close=function(){!0===i.getWrapperInstance().isOpen&&this.toggle()};this.isOpen=i.getWrapperInstance().isOpen};
